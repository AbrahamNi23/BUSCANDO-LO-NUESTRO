<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Revista interactiva Turn.js - 70 Páginas</title>

<!-- jQuery y Turn.js desde CDN -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/blasten/turn.js/turn.min.js"></script>

<style>
  :root{
    --cover-bg: #111;
    --ink: #111;
    --paper: #fff;
    --accent: #4cc9f0;
  }
  body{ 
    margin:0; 
    background:#1a1a1a; 
    color:#fff; 
    font-family:system-ui, sans-serif; 
    overflow-x: hidden;
  }
  .wrap{
    width:100%;
    height:100vh;
    display:flex; 
    align-items:center; 
    justify-content:center;
    padding: 20px 0;
    box-sizing: border-box;
  }

  /* Contenedor del libro (se auto-centra) */
  #magazine{
    width:95vw;
    height:80vh;
    max-width: 1400px;
    box-shadow:0 20px 50px rgba(0,0,0,0.6);
    background:#222;
    border-radius:8px;
    margin: 0 auto;
  }

  /* Cada página interna (Turn.js las posiciona) */
  .page{
    width:47.5vw;   /* ancho de cada página individual */
    height:80vh;    /* alto de cada página */
    background:var(--paper);
    color:var(--ink);
    overflow:hidden;
    position: relative;
  }

  .page__inner{
    width:100%;
    height:100%;
    display:flex;
    flex-direction: column;
    align-items:center;
    justify-content:center;
    padding:0;
  }
  
  .page img {
    width:100%;
    height:100%;
    object-fit: cover;
    display:block;
  }

  .cover{
    display:flex; 
    align-items:center; 
    justify-content:center;
    background:linear-gradient(135deg, #0f172a, #1e293b);
    color:#e2e8f0;
    text-align: center;
  }
  
  .cover h1{ 
    font-size:2.4rem; 
    margin: 0;
    padding: 0 20px;
  }
  
  .cover p {
    margin-top: 1rem;
    font-size: 1.2rem;
  }

  .controls{
    position:fixed; 
    bottom:20px; 
    left:50%; 
    transform:translateX(-50%);
    display:flex; 
    gap:0.75rem;
    z-index: 100;
  }
  
  .btn{
    padding:0.6rem 1rem; 
    border:none; 
    border-radius:8px;
    background:var(--accent); 
    color:#072a38; 
    font-weight:700; 
    cursor:pointer;
    transition: all 0.2s ease;
  }
  
  .btn:hover {
    background: #3ab9e0;
    transform: translateY(-2px);
  }
  
  .page-number {
    position: absolute;
    bottom: 10px;
    right: 10px;
    background: rgba(0,0,0,0.5);
    color: white;
    padding: 5px 10px;
    border-radius: 4px;
    font-size: 14px;
  }

  @media (max-width:768px){
    .wrap {
      padding: 10px 0;
    }
    
    #magazine{ 
      width:98vw; 
      height:75vh; 
    }
    
    .page{ 
      width:49vw; 
      height:75vh; 
    }
    
    .cover h1 {
      font-size: 1.8rem;
    }
    
    .cover p {
      font-size: 1rem;
    }
  }
</style>
</head>
<body>
<div class="wrap">
  <!-- El contenedor que Turn.js usará -->
  <div id="magazine">
    <!-- Portada (página 1) -->
    <div class="page cover">
      <div class="page__inner">
        <h1>Revista Digital</h1>
        <p>Edición Especial • 70 Páginas</p>
        <p>Arrastra el borde o usa los botones para navegar</p>
      </div>
    </div>
    
    <!-- Páginas 2-69 (imágenes) -->
    <!-- Se generarán dinámicamente con JavaScript -->
    
    <!-- Contraportada (página 70) -->
    <div class="page cover">
      <div class="page__inner">
        <h1>Fin • Gracias por leer</h1>
        <p>Edición Especial Completa</p>
      </div>
    </div>
  </div>
</div>

<div class="controls">
  <button class="btn" id="prev">‹ Anterior</button>
  <button class="btn" id="next">Siguiente ›</button>
</div>

<script>
  $(function(){
    // Generar dinámicamente las páginas 2-69
    const magazine = $('#magazine');
    
    // Insertar páginas 2-69 antes de la contraportada
    for (let i = 2; i <= 69; i++) {
      const pageDiv = $('<div class="page"></div>');
      const innerDiv = $('<div class="page__inner"></div>');
      
      // Usar picsum.photos para imágenes aleatorias con proporción 8.5:11
      // Calculamos dimensiones que mantengan la proporción 8.5:11
      const width = 850;
      const height = 1100;
      const imageUrl = `https://picsum.photos/seed/page${i}/${width}/${height}.jpg`;
      
      const img = $(`<img src="${imageUrl}" alt="Página ${i}">`);
      const pageNumber = $(`<div class="page-number">${i}</div>`);
      
      innerDiv.append(img);
      innerDiv.append(pageNumber);
      pageDiv.append(innerDiv);
      
      // Insertar antes de la contraportada
      $('.page:last').before(pageDiv);
    }
    
    // Calcular dimensiones manteniendo proporción 8.5:11
    function calculateDimensions() {
      const viewportWidth = $(window).width();
      const viewportHeight = $(window).height();
      
      // Ancho máximo para cada página (mitad del viewport con margen)
      const maxWidth = Math.min(viewportWidth * 0.95 / 2, 700);
      
      // Altura máxima (80% del viewport)
      const maxHeight = viewportHeight * 0.8;
      
      // Calcular altura manteniendo proporción 8.5:11
      const calculatedHeight = maxWidth * (11 / 8.5);
      
      // Si la altura calculada excede el máximo, ajustamos por altura
      if (calculatedHeight > maxHeight) {
        return {
          width: maxHeight * (8.5 / 11),
          height: maxHeight
        };
      }
      
      return {
        width: maxWidth,
        height: calculatedHeight
      };
    }
    
    const dimensions = calculateDimensions();
    
    // Inicializar Turn.js
    magazine.turn({
      width: dimensions.width * 2,   // ancho total del spread (dos páginas)
      height: dimensions.height,      // alto del spread
      autoCenter: true,              // centra el libro en el contenedor
      display: 'double',             // doble página (como revista real)
      acceleration: true,             // optimiza animación
      gradients: true,                // sombras/pliegues
      elevation: 50,                  // "altura" del pliegue
      when: {
        turning: function(e, page, view) {
          // Actualizar controles según la página actual
          $('#prev').toggleClass('disabled', page === 1);
          $('#next').toggleClass('disabled', page === 70);
        }
      }
    });
    
    // Controles
    $('#next').on('click', function(){ 
      if (!$(this).hasClass('disabled')) {
        magazine.turn('next'); 
      }
    });
    
    $('#prev').on('click', function(){ 
      if (!$(this).hasClass('disabled')) {
        magazine.turn('previous'); 
      }
    });
    
    // Zonas clicables: derecha avanza, izquierda retrocede
    magazine.on('click', function(e){
      const rect = this.getBoundingClientRect();
      const x = e.clientX - rect.left;
      
      if (x > rect.width * 0.6) {
        magazine.turn('next');
      } else if (x < rect.width * 0.4) {
        magazine.turn('previous');
      }
    });
    
    // Teclado
    $(document).on('keydown', function(e){
      if (e.key === 'ArrowRight') {
        magazine.turn('next');
      } else if (e.key === 'ArrowLeft') {
        magazine.turn('previous');
      }
    });
    
    // Reajuste al cambiar tamaño
    $(window).on('resize', function(){
      const newDimensions = calculateDimensions();
      magazine.turn('size', newDimensions.width * 2, newDimensions.height);
      
      // Actualizar CSS para las páginas
      $('.page').css({
        width: newDimensions.width,
        height: newDimensions.height
      });
    });
    
    // Actualizar estado inicial de los botones
    $('#prev').addClass('disabled');
  });
</script>
</body>
</html>
